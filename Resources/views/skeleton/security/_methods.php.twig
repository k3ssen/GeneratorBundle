{# @var meta_entity \K3ssen\GeneratorBundle\MetaData\MetaEntityInterface #}
{# @var generate_options \K3ssen\GeneratorBundle\Generator\CrudGenerateOptions #}
{% block methods %}

    protected function supports($attribute, $subject)
    {
        if ($subject !== null && $subject instanceOf {{ meta_entity.name }} === false) {
            return false;
        }
        return in_array($attribute, [
            static::INDEX,
            static::VIEW,
            static::CREATE,
            static::EDIT,
            static::DELETE,
        ], true);
    }

    /**
     * @var {{ meta_entity.name }}|null $object the entity object
     */
    protected function voteOnAttribute($attribute, $subject, TokenInterface $token)
    {
        switch ($attribute) {
            case self::INDEX:
            case self::CREATE:
                return true;
            case self::VIEW:
{% if generate_options.useWriteActions %}
            case self::EDIT:
            case self::DELETE:
{% endif %}
                return $subject !== null;
        }
        return null;
    }
{% endblock %}